@model AnimeCentralWeb.Models.DomainViewModels.AnimeViewModel

<div class="content">
    <div class="content-header">
        <div class="title">@Model.Title</div>
        <div class="description">@Model.Type</div>
    </div>
    <div class="commands text-right">
        <i class="fa fa-times close-pop-up command" aria-hidden="true"></i>
    </div>
    <div class="content-body anime">
        <table>
            <tr>
                <td>
                    <div class="anime-details">
                        <div class="cover">
                            <img src="@Model.Image" />
                            <span class="score">@Model.Score</span>
                        </div>
                        <div class="details">
                            <label asp-for="NoOfEpisodes"></label>: <span class="noOfEpisodes">@Model.NoOfEpisodes</span><br />
                            <label asp-for="Status"></label>: <span class="noOfEpisodes">@Model.Status</span><br />
                            <label asp-for="Synonyms"></label>: <span class="noOfEpisodes">@Model.Synonyms</span><br />
                        </div>
                    </div>
                </td>
                <td class="anime-description multi-tab">
                    <table class="tabs-labels">
                        <tr>
                            <td data-tab-target="#1" class="tab-label active">Descriere</td>
                            <td data-tab-target="#2" class="tab-label">Episoade</td>
                            <td data-tab-target="#3" class="tab-label">Recenzii</td>
                        </tr>
                    </table>
                    <div class="tabs">
                        <div class="tab active" data-tab-id="#1">
                            <div>@Html.Raw(Model.Synopsis.Replace("\\n", string.Empty))</div>
                        </div>
                        <div class="tab" data-tab-id="#2">
                            <div class="anime-episodes-list">
                                @foreach (var episode in Model.Episodes)
                                {
                                    <div class="anime-episode" data-episode-id="@episode.Id">Episodul #@episode.Order@(string.IsNullOrEmpty(episode.Title) ? "" : ": " + episode.Title)</div>
                                }
                            </div>
                            <table class="tab-commands">
                                <tr>
                                    <td class="tab-command add-episode" data-anime-id="@Model.Id">Adauga Episod <i class="fa fa-video-camera" aria-hidden="true"></i></td>
                                </tr>
                            </table>
                        </div>
                        <div class="tab" data-tab-id="#3">
                            Recenzii
                            <div class="tab-commands"></div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <script>
        $(".multi-tab .tab-label").click(function () {
            var tabTargetId = $(this).attr("data-tab-target");
            var multiTabContainer = $(this).closest(".multi-tab");

            multiTabContainer.find(".tab-label").removeClass("active");
            multiTabContainer.find(".tab").removeClass("active");

            $(this).addClass("active");
            multiTabContainer.find(".tab[data-tab-id='" + tabTargetId + "']").addClass("active");
        });

        $(".add-episode").click(function () {
            var animeId = $(this).attr("data-anime-id");
            $.get("Anime/GetAddEpisodePartial?animeId=" + animeId, function (data) {
                $(".pop-up").append(data);
            }).fail(function () {
                alert("A aparut o eroare in adaugarea episodul.");
            });

        })

        $(".anime-episodes-list .anime-episode").click(function () {
            var episodeId = $(this).attr("data-episode-id");
            $.get("Anime/GetEpisodePartial?id=" + episodeId, function (data) {
                $(".pop-up").append(data);
            }).fail(function () {
                alert("A aparut o eroare in cautarea episodului.");
            })
        })
    </script>
</div>

